{"version":3,"file":"index.js","sources":["../../../src/utils/removeTrailingSlash.js","../../../src/config/index.js","../../../src/utils/version.js","../../../src/components/CreateOrgLink.js","../../../src/components/LoginLink.js","../../../src/components/LogoutLink.js","../../../src/components/RegisterLink.js"],"sourcesContent":["export function removeTrailingSlash(url) {\n  if (url === undefined || url === null) return undefined;\n\n  url = url.trim();\n\n  if (url.endsWith('/')) {\n    url = url.slice(0, -1);\n  }\n\n  return url;\n}\n","import {version} from '../utils/version';\nimport {removeTrailingSlash} from '../utils/removeTrailingSlash';\n\n/**\n * @type {import('../../types').KindeState}\n */\nconst initialState = {\n  accessToken: null,\n  idToken: null,\n  isAuthenticated: false,\n  isLoading: true,\n  organization: null,\n  permissions: [],\n  user: null,\n  userOrganizations: [],\n  getAccessToken: () => null,\n  getBooleanFlag: () => null,\n  getClaim: () => null,\n  getFlag: () => null,\n  getIdToken: () => null,\n  getIntegerFlag: () => null,\n  getOrganization: () => null,\n  getPermission: () => null,\n  getPermissions: () => [],\n  getStringFlag: () => null,\n  getToken: () => null,\n  getUser: () => null,\n  getUserOrganizations: () => null,\n  refreshData: () => null\n};\n\nconst SESSION_PREFIX = 'pkce-verifier';\n\nconst KINDE_SITE_URL = removeTrailingSlash(process.env.KINDE_SITE_URL);\n\n// We need to use NEXT_PUBLIC for frontend vars\nconst KINDE_AUTH_API_PATH =\n  removeTrailingSlash(process.env.NEXT_PUBLIC_KINDE_AUTH_API_PATH) ||\n  removeTrailingSlash(process.env.KINDE_AUTH_API_PATH) ||\n  '/api/auth';\n\nconst KINDE_POST_LOGIN_REDIRECT_URL =\n  removeTrailingSlash(process.env.KINDE_POST_LOGIN_REDIRECT_URL) ||\n  removeTrailingSlash(process.env.KINDE_POST_LOGIN_URL_REDIRECT_URL);\nconst KINDE_POST_LOGOUT_REDIRECT_URL = removeTrailingSlash(\n  process.env.KINDE_POST_LOGOUT_REDIRECT_URL\n);\n\nconst KINDE_ISSUER_URL = removeTrailingSlash(process.env.KINDE_ISSUER_URL);\nconst KINDE_CLIENT_ID = process.env.KINDE_CLIENT_ID;\nconst KINDE_CLIENT_SECRET = process.env.KINDE_CLIENT_SECRET;\nconst KINDE_AUDIENCE = process.env.KINDE_AUDIENCE;\nconst KINDE_COOKIE_DOMAIN = removeTrailingSlash(\n  process.env.KINDE_COOKIE_DOMAIN\n);\nconst KINDE_SCOPE = process.env.KINDE_SCOPE || 'openid profile email offline';\n\nconst isDebugMode = process.env.KINDE_DEBUG_MODE === 'true';\n\nexport const config = {\n  isDebugMode,\n  apiPath: KINDE_AUTH_API_PATH,\n  initialState,\n  SESSION_PREFIX,\n  redirectURL: KINDE_SITE_URL,\n  postLoginRedirectURL: KINDE_POST_LOGIN_REDIRECT_URL,\n  issuerURL: KINDE_ISSUER_URL,\n  clientID: KINDE_CLIENT_ID,\n  clientSecret: KINDE_CLIENT_SECRET,\n  postLogoutRedirectURL: KINDE_POST_LOGOUT_REDIRECT_URL,\n  audience: KINDE_AUDIENCE ? KINDE_AUDIENCE.split(' ') : '',\n  cookieDomain: KINDE_COOKIE_DOMAIN,\n  responseType: 'code',\n  codeChallengeMethod: 'S256',\n  redirectRoutes: {\n    callback: `${KINDE_AUTH_API_PATH}/kinde_callback`\n  },\n  issuerRoutes: {\n    logout: '/logout',\n    login: '/oauth2/auth',\n    register: '/oauth2/auth',\n    token: '/oauth2/token',\n    profile: '/oauth2/v2/user_profile'\n  },\n  clientOptions: {\n    audience: KINDE_AUDIENCE ? KINDE_AUDIENCE.split(' ') : '',\n    authDomain: KINDE_ISSUER_URL || '',\n    clientId: KINDE_CLIENT_ID || '',\n    clientSecret: KINDE_CLIENT_SECRET || '',\n    logoutRedirectURL: KINDE_POST_LOGOUT_REDIRECT_URL || '',\n    redirectURL: `${KINDE_SITE_URL}/api/auth/kinde_callback`,\n    frameworkVersion: version,\n    scope: KINDE_SCOPE\n  },\n  grantType: 'AUTHORIZATION_CODE'\n};\n","// Generated by genversion.\nexport const version = '2.4.6'\n","import React from 'react';\n\nimport {config} from '../config/index';\n/**\n * @typedef {Object} PropsType\n * @prop {React.ReactNode} children\n * @prop {string} [orgName]\n *\n * @typedef {PropsType & React.AnchorHTMLAttributes<HTMLAnchorElement>} Props\n */\n\n/**\n * @param {Props} props\n */\nexport function CreateOrgLink({children, orgName, ...props}) {\n  return (\n    <a\n      href={`${config.apiPath}/create_org${\n        orgName ? `?org_name=${orgName}` : ''\n      }`}\n      {...props}\n    >\n      {children}\n    </a>\n  );\n}\n","import React from 'react';\nimport {config} from '../config/index';\n\n/**\n * @typedef {Object} PropsType\n * @prop {React.ReactNode} children\n * @prop {string} [orgCode]\n * @prop {string} [postLoginRedirectURL]\n * @prop {Object.<string, string>} [authUrlParams]\n *\n * @typedef {PropsType & React.AnchorHTMLAttributes<HTMLAnchorElement>} Props\n */\n\n/**\n * @param {Props} props\n */\nexport function LoginLink({\n  children,\n  postLoginRedirectURL,\n  orgCode,\n  authUrlParams,\n  ...props\n}) {\n  const params = new URLSearchParams();\n  let paramsObj = {};\n  if (orgCode != null) paramsObj.org_code = orgCode;\n  if (postLoginRedirectURL != null) {\n    if (postLoginRedirectURL?.startsWith('/')) {\n      const host =\n        typeof window !== 'undefined'\n          ? window.location.origin\n          : process.env.KINDE_SITE_URL;\n      postLoginRedirectURL = `${host}${postLoginRedirectURL}`;\n    }\n    paramsObj.post_login_redirect_url = postLoginRedirectURL;\n  }\n\n  paramsObj = {...authUrlParams, ...paramsObj};\n\n  for (const key in paramsObj) params.append(key, paramsObj[key]);\n\n  const authUrl = `${config.apiPath}/login${\n    params ? `?${params.toString()}` : ''\n  }`;\n  return (\n    <a href={authUrl} {...props}>\n      {children}\n    </a>\n  );\n}\n","import React from 'react';\n\nimport {config} from '../config/index';\n/**\n * @typedef {Object} PropsType\n * @prop {React.ReactNode} children\n * @prop {string} [postLogoutRedirectURL]\n *\n * @typedef {PropsType & React.AnchorHTMLAttributes<HTMLAnchorElement>} Props\n */\n\n/**\n * @param {Props} props\n */\nexport function LogoutLink({children, postLogoutRedirectURL, ...props}) {\n  return (\n    <a\n      href={`${config.apiPath}/logout${\n        postLogoutRedirectURL\n          ? `?post_logout_redirect_url=${postLogoutRedirectURL}`\n          : ''\n      }\n      `}\n      {...props}\n    >\n      {children}\n    </a>\n  );\n}\n","import React from 'react';\nimport {config} from '../config/index';\n\n/**\n * @typedef {Object} PropsType\n * @prop {React.ReactNode} children\n * @prop {string} [orgCode]\n * @prop {string} [postLoginRedirectURL]\n * @prop {Object.<string, string>} [authUrlParams]\n *\n * @typedef {PropsType & React.AnchorHTMLAttributes<HTMLAnchorElement>} Props\n */\n\n/**\n * @param {Props} props\n */\n\nexport function RegisterLink({\n  children,\n  orgCode,\n  postLoginRedirectURL,\n  authUrlParams,\n  ...props\n}) {\n  let params = new URLSearchParams();\n  let paramsObj = {};\n  if (orgCode != null) paramsObj.org_code = orgCode;\n  if (postLoginRedirectURL != null)\n    paramsObj.post_login_redirect_url = postLoginRedirectURL;\n\n  paramsObj = {...authUrlParams, ...paramsObj};\n\n  for (const key in paramsObj) params.append(key, paramsObj[key]);\n  return (\n    <a\n      href={`${config.apiPath}/register${\n        params ? `?${params.toString()}` : ''\n      }`}\n      {...props}\n    >\n      {children}\n    </a>\n  );\n}\n"],"names":["removeTrailingSlash","url","trim","endsWith","slice","KINDE_SITE_URL","process","env","KINDE_AUTH_API_PATH","NEXT_PUBLIC_KINDE_AUTH_API_PATH","KINDE_POST_LOGIN_REDIRECT_URL","KINDE_POST_LOGIN_URL_REDIRECT_URL","KINDE_POST_LOGOUT_REDIRECT_URL","KINDE_ISSUER_URL","KINDE_CLIENT_ID","KINDE_CLIENT_SECRET","KINDE_AUDIENCE","KINDE_COOKIE_DOMAIN","KINDE_SCOPE","config","isDebugMode","KINDE_DEBUG_MODE","apiPath","initialState","accessToken","idToken","isAuthenticated","isLoading","organization","permissions","user","userOrganizations","getAccessToken","getBooleanFlag","getClaim","getFlag","getIdToken","getIntegerFlag","getOrganization","getPermission","getPermissions","getStringFlag","getToken","getUser","getUserOrganizations","refreshData","SESSION_PREFIX","redirectURL","postLoginRedirectURL","issuerURL","clientID","clientSecret","postLogoutRedirectURL","audience","split","cookieDomain","responseType","codeChallengeMethod","redirectRoutes","callback","concat","issuerRoutes","logout","login","register","token","profile","clientOptions","authDomain","clientId","logoutRedirectURL","frameworkVersion","scope","grantType","_ref","children","orgName","props","_objectWithoutProperties","_excluded","React","createElement","_extends","href","orgCode","authUrlParams","params","URLSearchParams","paramsObj","org_code","_postLoginRedirectURL","startsWith","host","window","location","origin","post_login_redirect_url","key","_objectSpread","append","authUrl","toString"],"mappings":"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"}