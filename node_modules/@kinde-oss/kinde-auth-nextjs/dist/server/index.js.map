{"version":3,"file":"index.js","sources":["../../node_modules/tslib/tslib.es6.js","../../src/utils/isAppRouter.js","../../src/utils/removeTrailingSlash.js","../../src/config/index.js","../../src/utils/version.js","../../src/session/sessionManager.js","../../src/session/getAccessToken.js","../../../src/session/kindeServerClient.ts","../../src/session/getFlag.js","../../src/session/getBooleanFlag.js","../../src/session/getIdToken.js","../../src/session/getIntegerFlag.js","../../src/session/getOrganization.js","../../src/session/getPermission.js","../../src/session/getPermissions.js","../../src/session/getStringFlag.js","../../../src/utils/generateUserObject.ts","../../../src/session/getUser.ts","../../../src/session/getUserOrganizations.ts","../../src/utils/pageRouter/isTokenValid.js","../../src/session/isAuthenticated.js","../../src/session/getAccessTokenRaw.js","../../src/session/getIdTokenRaw.js","../../src/session/getRoles.js","../../src/session/getClaim.js","../../../src/session/index.ts","../../../src/authMiddleware/authMiddleware.ts","../../src/components/RegisterLink.js","../../src/components/LoginLink.js","../../src/components/LogoutLink.js","../../src/components/CreateOrgLink.js","../../src/api-client.js","../../src/routerClients/RouterClient.js","../../src/handlers/createOrg.js","../../src/handlers/login.js","../../src/handlers/logout.js","../../src/handlers/health.js","../../src/handlers/register.js","../../src/routerClients/AppRouterClient.js","../../src/routerClients/PagesRouterClient.js","../../src/handlers/auth.js","../../../src/handlers/setup.ts","../../../src/handlers/callback.ts","../../src/handlers/protect.js"],"sourcesContent":["/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise, SuppressedError, Symbol */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\r\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\r\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\r\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\r\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\r\n    var _, done = false;\r\n    for (var i = decorators.length - 1; i >= 0; i--) {\r\n        var context = {};\r\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\r\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\r\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\r\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\r\n        if (kind === \"accessor\") {\r\n            if (result === void 0) continue;\r\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\r\n            if (_ = accept(result.get)) descriptor.get = _;\r\n            if (_ = accept(result.set)) descriptor.set = _;\r\n            if (_ = accept(result.init)) initializers.unshift(_);\r\n        }\r\n        else if (_ = accept(result)) {\r\n            if (kind === \"field\") initializers.unshift(_);\r\n            else descriptor[key] = _;\r\n        }\r\n    }\r\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\r\n    done = true;\r\n};\r\n\r\nexport function __runInitializers(thisArg, initializers, value) {\r\n    var useValue = arguments.length > 2;\r\n    for (var i = 0; i < initializers.length; i++) {\r\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\r\n    }\r\n    return useValue ? value : void 0;\r\n};\r\n\r\nexport function __propKey(x) {\r\n    return typeof x === \"symbol\" ? x : \"\".concat(x);\r\n};\r\n\r\nexport function __setFunctionName(f, name, prefix) {\r\n    if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\r\n    return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\r\n};\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n\r\nexport function __addDisposableResource(env, value, async) {\r\n    if (value !== null && value !== void 0) {\r\n        if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\r\n        var dispose;\r\n        if (async) {\r\n            if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\r\n            dispose = value[Symbol.asyncDispose];\r\n        }\r\n        if (dispose === void 0) {\r\n            if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\r\n            dispose = value[Symbol.dispose];\r\n        }\r\n        if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\r\n        env.stack.push({ value: value, dispose: dispose, async: async });\r\n    }\r\n    else if (async) {\r\n        env.stack.push({ async: true });\r\n    }\r\n    return value;\r\n}\r\n\r\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\r\n\r\nexport function __disposeResources(env) {\r\n    function fail(e) {\r\n        env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\r\n        env.hasError = true;\r\n    }\r\n    function next() {\r\n        while (env.stack.length) {\r\n            var rec = env.stack.pop();\r\n            try {\r\n                var result = rec.dispose && rec.dispose.call(rec.value);\r\n                if (rec.async) return Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\r\n            }\r\n            catch (e) {\r\n                fail(e);\r\n            }\r\n        }\r\n        if (env.hasError) throw env.error;\r\n    }\r\n    return next();\r\n}\r\n\r\nexport default {\r\n    __extends: __extends,\r\n    __assign: __assign,\r\n    __rest: __rest,\r\n    __decorate: __decorate,\r\n    __param: __param,\r\n    __metadata: __metadata,\r\n    __awaiter: __awaiter,\r\n    __generator: __generator,\r\n    __createBinding: __createBinding,\r\n    __exportStar: __exportStar,\r\n    __values: __values,\r\n    __read: __read,\r\n    __spread: __spread,\r\n    __spreadArrays: __spreadArrays,\r\n    __spreadArray: __spreadArray,\r\n    __await: __await,\r\n    __asyncGenerator: __asyncGenerator,\r\n    __asyncDelegator: __asyncDelegator,\r\n    __asyncValues: __asyncValues,\r\n    __makeTemplateObject: __makeTemplateObject,\r\n    __importStar: __importStar,\r\n    __importDefault: __importDefault,\r\n    __classPrivateFieldGet: __classPrivateFieldGet,\r\n    __classPrivateFieldSet: __classPrivateFieldSet,\r\n    __classPrivateFieldIn: __classPrivateFieldIn,\r\n    __addDisposableResource: __addDisposableResource,\r\n    __disposeResources: __disposeResources,\r\n};\r\n","export const isAppRouter = (req) => {\n  return req instanceof Request;\n};\n","export function removeTrailingSlash(url) {\n  if (url === undefined || url === null) return undefined;\n\n  url = url.trim();\n\n  if (url.endsWith('/')) {\n    url = url.slice(0, -1);\n  }\n\n  return url;\n}\n","import {version} from '../utils/version';\nimport {removeTrailingSlash} from '../utils/removeTrailingSlash';\n\n/**\n * @type {import('../../types').KindeState}\n */\nconst initialState = {\n  accessToken: null,\n  idToken: null,\n  isAuthenticated: false,\n  isLoading: true,\n  organization: null,\n  permissions: [],\n  user: null,\n  userOrganizations: [],\n  getAccessToken: () => null,\n  getBooleanFlag: () => null,\n  getClaim: () => null,\n  getFlag: () => null,\n  getIdToken: () => null,\n  getIntegerFlag: () => null,\n  getOrganization: () => null,\n  getPermission: () => null,\n  getPermissions: () => [],\n  getStringFlag: () => null,\n  getToken: () => null,\n  getUser: () => null,\n  getUserOrganizations: () => null,\n  refreshData: () => null\n};\n\nconst SESSION_PREFIX = 'pkce-verifier';\n\nconst KINDE_SITE_URL = removeTrailingSlash(process.env.KINDE_SITE_URL);\n\n// We need to use NEXT_PUBLIC for frontend vars\nconst KINDE_AUTH_API_PATH =\n  removeTrailingSlash(process.env.NEXT_PUBLIC_KINDE_AUTH_API_PATH) ||\n  removeTrailingSlash(process.env.KINDE_AUTH_API_PATH) ||\n  '/api/auth';\n\nconst KINDE_POST_LOGIN_REDIRECT_URL =\n  removeTrailingSlash(process.env.KINDE_POST_LOGIN_REDIRECT_URL) ||\n  removeTrailingSlash(process.env.KINDE_POST_LOGIN_URL_REDIRECT_URL);\nconst KINDE_POST_LOGOUT_REDIRECT_URL = removeTrailingSlash(\n  process.env.KINDE_POST_LOGOUT_REDIRECT_URL\n);\n\nconst KINDE_ISSUER_URL = removeTrailingSlash(process.env.KINDE_ISSUER_URL);\nconst KINDE_CLIENT_ID = process.env.KINDE_CLIENT_ID;\nconst KINDE_CLIENT_SECRET = process.env.KINDE_CLIENT_SECRET;\nconst KINDE_AUDIENCE = process.env.KINDE_AUDIENCE;\nconst KINDE_COOKIE_DOMAIN = removeTrailingSlash(\n  process.env.KINDE_COOKIE_DOMAIN\n);\nconst KINDE_SCOPE = process.env.KINDE_SCOPE || 'openid profile email offline';\n\nconst isDebugMode = process.env.KINDE_DEBUG_MODE === 'true';\n\nexport const config = {\n  isDebugMode,\n  apiPath: KINDE_AUTH_API_PATH,\n  initialState,\n  SESSION_PREFIX,\n  redirectURL: KINDE_SITE_URL,\n  postLoginRedirectURL: KINDE_POST_LOGIN_REDIRECT_URL,\n  issuerURL: KINDE_ISSUER_URL,\n  clientID: KINDE_CLIENT_ID,\n  clientSecret: KINDE_CLIENT_SECRET,\n  postLogoutRedirectURL: KINDE_POST_LOGOUT_REDIRECT_URL,\n  audience: KINDE_AUDIENCE ? KINDE_AUDIENCE.split(' ') : '',\n  cookieDomain: KINDE_COOKIE_DOMAIN,\n  responseType: 'code',\n  codeChallengeMethod: 'S256',\n  redirectRoutes: {\n    callback: `${KINDE_AUTH_API_PATH}/kinde_callback`\n  },\n  issuerRoutes: {\n    logout: '/logout',\n    login: '/oauth2/auth',\n    register: '/oauth2/auth',\n    token: '/oauth2/token',\n    profile: '/oauth2/v2/user_profile'\n  },\n  clientOptions: {\n    audience: KINDE_AUDIENCE ? KINDE_AUDIENCE.split(' ') : '',\n    authDomain: KINDE_ISSUER_URL || '',\n    clientId: KINDE_CLIENT_ID || '',\n    clientSecret: KINDE_CLIENT_SECRET || '',\n    logoutRedirectURL: KINDE_POST_LOGOUT_REDIRECT_URL || '',\n    redirectURL: `${KINDE_SITE_URL}/api/auth/kinde_callback`,\n    frameworkVersion: version,\n    scope: KINDE_SCOPE\n  },\n  grantType: 'AUTHORIZATION_CODE'\n};\n","// Generated by genversion.\nexport const version = '2.4.6'\n","import {cookies} from 'next/headers';\nimport {isAppRouter} from '../utils/isAppRouter';\nimport {config} from '../config/index';\n\nvar cookie = require('cookie');\n\nconst TWENTY_NINE_DAYS = 2505600;\n\nexport const GLOBAL_COOKIE_OPTIONS = {\n  sameSite: 'lax',\n  httpOnly: true,\n  secure: process.env.NODE_ENV === 'production',\n  path: '/'\n};\n\nconst COOKIE_LIST = [\n  'id_token_payload',\n  'id_token',\n  'access_token_payload',\n  'access_token',\n  'user',\n  'refresh_token',\n  'post_login_redirect_url'\n];\n\n/**\n *\n * @param {import('next').NextApiRequest} [req]\n * @param {import('next').NextApiResponse} [res]\n * @returns {Promise<import('@kinde-oss/kinde-typescript-sdk').SessionManager>}\n */\nexport const sessionManager = async (req, res) => {\n  try {\n    const cookieStore = await cookies();\n    if (!req) return appRouterSessionManager(cookieStore);\n    return isAppRouter(req)\n      ? appRouterSessionManager(cookieStore)\n      : pageRouterSessionManager(req, res);\n  } catch (error) {\n    throw error;\n  }\n};\n\n/**\n *\n * @param {import(\"next/dist/server/web/spec-extension/adapters/request-cookies\").ReadonlyRequestCookies} cookieStore\n * @returns {import('@kinde-oss/kinde-typescript-sdk').SessionManager}\n */\nexport const appRouterSessionManager = (cookieStore) => ({\n  /**\n   *\n   * @param {string} itemKey\n   * @returns {Promise<string | object | null>}\n   */\n  getSessionItem: (itemKey) => {\n    const item = cookieStore.get(itemKey);\n    if (item) {\n      try {\n        const jsonValue = JSON.parse(item.value);\n        if (typeof jsonValue === 'object') {\n          return jsonValue;\n        }\n        return item.value;\n      } catch (error) {\n        return item.value;\n      }\n    }\n    return null;\n  },\n  /**\n   *\n   * @param {string} itemKey\n   * @param {any} itemValue\n   * @returns {Promise<void>}\n   */\n  setSessionItem: (itemKey, itemValue) => {\n    if (itemValue !== undefined) {\n      cookieStore.set(\n        itemKey,\n        typeof itemValue === 'object' ? JSON.stringify(itemValue) : itemValue,\n        {\n          maxAge: TWENTY_NINE_DAYS,\n          domain: config.cookieDomain ? config.cookieDomain : undefined,\n          ...GLOBAL_COOKIE_OPTIONS\n        }\n      );\n    }\n  },\n  /**\n   *\n   * @param {string} itemKey\n   * @returns {Promise<void>}\n   */\n  removeSessionItem: (itemKey) => {\n    cookieStore.set(itemKey, '', {\n      domain: config.cookieDomain ? config.cookieDomain : undefined,\n      maxAge: 0,\n      ...GLOBAL_COOKIE_OPTIONS\n    });\n  },\n  /**\n   * @returns {Promise<void>}\n   */\n  destroySession: () => {\n    COOKIE_LIST.forEach((name) =>\n      cookieStore.set(name, '', {\n        domain: config.cookieDomain ? config.cookieDomain : undefined,\n        maxAge: 0,\n        ...GLOBAL_COOKIE_OPTIONS\n      })\n    );\n  }\n});\n\n/**\n *\n * @param {import('next/types').NextApiRequest} req\n * @param {import('next').NextApiResponse} [res]\n * @returns {import('@kinde-oss/kinde-typescript-sdk').SessionManager}\n */\nexport const pageRouterSessionManager = (req, res) => {\n  return {\n    /**\n     *\n     * @param {string} itemKey\n     * @returns {Promise<string | undefined>}\n     */\n    getSessionItem: (itemKey) => {\n      const itemValue = req.cookies[itemKey];\n      if (itemValue) {\n        try {\n          const jsonValue = JSON.parse(itemValue);\n          if (typeof jsonValue === 'object') {\n            return jsonValue;\n          }\n          return itemValue;\n        } catch (error) {\n          return itemValue;\n        }\n      }\n    },\n    /**\n     *\n     * @param {string} itemKey\n     * @param {any} itemValue\n     * @returns {Promise<void>}\n     */\n    setSessionItem: (itemKey, itemValue) => {\n      let cookies = res?.getHeader('Set-Cookie') || [];\n\n      if (!Array.isArray(cookies)) {\n        cookies = [cookies.toString()];\n      }\n\n      res?.setHeader('Set-Cookie', [\n        ...cookies.filter((cookie) => !cookie.startsWith(`${itemKey}=`)),\n        cookie.serialize(\n          itemKey,\n          typeof itemValue === 'object' ? JSON.stringify(itemValue) : itemValue,\n          {\n            domain: config.cookieDomain ? config.cookieDomain : undefined,\n            ...GLOBAL_COOKIE_OPTIONS,\n            maxAge: TWENTY_NINE_DAYS\n          }\n        )\n      ]);\n    },\n    /**\n     *\n     * @param {string} itemKey\n     * @returns {Promise<void>}\n     */\n    removeSessionItem: (itemKey) => {\n      res?.setHeader('Set-Cookie', [\n        cookie.serialize(itemKey, '', {\n          domain: config.cookieDomain ? config.cookieDomain : undefined,\n          maxAge: -1,\n          ...GLOBAL_COOKIE_OPTIONS\n        })\n      ]);\n    },\n    destroySession: () => {\n      res?.setHeader('Set-Cookie', [\n        ...COOKIE_LIST.map((name) =>\n          cookie.serialize(name, '', {\n            domain: config.cookieDomain ? config.cookieDomain : undefined,\n            maxAge: -1,\n            ...GLOBAL_COOKIE_OPTIONS\n          })\n        )\n      ]);\n    }\n  };\n};\n","import {sessionManager} from './sessionManager';\nimport {config} from '../config/index';\nimport {jwtDecoder} from '@kinde/jwt-decoder';\n\n/**\n * @callback getAccessToken\n * @returns {Promise<import('../../types.js').KindeAccessToken | undefined>}\n */\n\n/**\n *\n * @param {import('next').NextApiRequest} [req]\n * @param {import('next').NextApiResponse} [res]\n *\n * @returns {getAccessToken}\n */\n// @ts-ignore\nexport const getAccessTokenFactory = (req, res) => async () => {\n  try {\n    return jwtDecoder(\n      await (await sessionManager(req, res)).getSessionItem('access_token')\n    );\n  } catch (err) {\n    if (config.isDebugMode) {\n      console.error(err);\n    }\n    return null;\n  }\n};\n","import {\n  createKindeServerClient,\n  GrantType\n} from '@kinde-oss/kinde-typescript-sdk';\nimport {config} from '../config/index';\n\nexport const kindeClient = createKindeServerClient(\n  GrantType.AUTHORIZATION_CODE,\n  config.clientOptions\n);\n","import {sessionManager} from './sessionManager';\nimport {kindeClient} from './kindeServerClient';\n\n/**\n * @callback getFlag\n * @param {string} code\n * @param {boolean | number | string} defaultValue\n * @param {import('../../types').KindeFlagTypeCode} flagType\n * @returns {Promise<import('../../types').KindeFlag | {value: boolean | number | string}>}\n */\n\n/**\n *\n * @param {import('next').NextApiRequest} [req]\n * @param {import('next').NextApiResponse} [res]\n * @returns {getFlag}\n */\nexport const getFlagFactory =\n  (req, res) => async (code, defaultValue, flagType) => {\n    try {\n      const flag = await kindeClient.getFlag(\n        await sessionManager(req, res),\n        code,\n        defaultValue,\n        flagType\n      );\n\n      return flag;\n    } catch (error) {\n      // @ts-ignore\n      if (error.message.includes('no default value has been provided')) {\n        throw error;\n      }\n      return {value: defaultValue};\n    }\n  };\n","import {getFlagFactory} from './getFlag';\nimport {config} from '../config/index';\n\n/**\n * @callback getBooleanFlag\n * @param {string} code\n * @param {boolean} defaultValue\n * @returns {Promise<boolean | null>}\n */\n\n/**\n *\n * @param {import('next').NextApiRequest} [req]\n * @param {import('next').NextApiResponse} [res]\n * @returns {getBooleanFlag}\n */\nexport const getBooleanFlagFactory =\n  (req, res) => async (code, defaultValue) => {\n    try {\n      const flag = await getFlagFactory(req, res)(code, defaultValue, 'b');\n      return flag.value;\n    } catch (err) {\n      if (config.isDebugMode) {\n        console.error(err);\n      }\n      return null;\n    }\n  };\n","import {sessionManager} from './sessionManager';\nimport {config} from '../config/index';\nimport {jwtDecoder} from '@kinde/jwt-decoder';\n\n/**\n * @callback getIdToken\n * @returns {Promise<import('../../types').KindeIdToken>}\n */\n\n/**\n *\n * @param {import('next').NextApiRequest} [req]\n * @param {import('next').NextApiResponse} [res]\n * @returns {getIdToken}\n */\n\n// @ts-ignore\nexport const getIdTokenFactory = (req, res) => async () => {\n  try {\n    return jwtDecoder(\n      await (await sessionManager(req, res)).getSessionItem('id_token')\n    );\n  } catch (err) {\n    if (config.isDebugMode) {\n      console.error(err);\n    }\n    return null;\n  }\n};\n","import {getFlagFactory} from './getFlag';\nimport {config} from '../config/index';\n\n/**\n * @callback getIntegerFlag\n * @param {string} code\n * @param {number} defaultValue\n * @returns {Promise<number | null>}\n */\n\n/**\n *\n * @param {import('next').NextApiRequest} [req]\n * @param {import('next').NextApiResponse} [res]\n * @returns {getIntegerFlag}\n */\nexport const getIntegerFlagFactory =\n  (req, res) => async (code, defaultValue) => {\n    try {\n      const flag = await getFlagFactory(req, res)(code, defaultValue, 'i');\n      return flag.value;\n    } catch (err) {\n      if (config.isDebugMode) {\n        console.error(err);\n      }\n      return null;\n    }\n  };\n","import {sessionManager} from './sessionManager';\nimport {kindeClient} from './kindeServerClient';\nimport {config} from '../config/index';\n/**\n * @callback getOrganization\n * @returns {Promise<import('../../types').KindeOrganization | null>}\n */\n\n/**\n *\n * @param {import('next').NextApiRequest} [req]\n * @param {import('next').NextApiResponse} [res]\n * @returns {getOrganization}\n */\nexport const getOrganizationFactory = (req, res) => async () => {\n  try {\n    const session = await sessionManager(req, res)\n    const org = await kindeClient.getOrganization(session);\n    const orgName = await kindeClient.getClaimValue(\n      session,\n      'org_name'\n    );\n    const orgProperties = await kindeClient.getClaimValue(\n      session,\n      'organization_properties'\n    );\n\n    return {\n      orgCode: org.orgCode,\n      orgName: orgName,\n      properties: {\n        city: orgProperties?.kp_org_city?.v,\n        industry: orgProperties?.kp_org_industry?.v,\n        postcode: orgProperties?.kp_org_postcode?.v,\n        state_region: orgProperties?.kp_org_state_region?.v,\n        street_address: orgProperties?.kp_org_street_address?.v,\n        street_address_2: orgProperties?.kp_org_street_address_2?.v\n      }\n    };\n  } catch (error) {\n    if (config.isDebugMode) {\n      console.error(error);\n    }\n    return null;\n  }\n};\n","import {sessionManager} from './sessionManager';\nimport {kindeClient} from './kindeServerClient';\nimport {config} from '../config/index';\n\n/**\n * @callback getPermission\n *  @param {string} name\n * @returns {Promise<import('../../types').KindePermission | null>}\n */\n\n/**\n *\n * @param {import('next').NextApiRequest} [req]\n * @param {import('next').NextApiResponse} [res]\n * @returns {getPermission}\n */\nexport const getPermissionFactory = (req, res) => async (name) => {\n  try {\n    const permission = await kindeClient.getPermission(\n      await sessionManager(req, res),\n      name\n    );\n    return permission;\n  } catch (error) {\n    if (config.isDebugMode) {\n      console.error(error);\n    }\n    return null;\n  }\n};\n","import {sessionManager} from './sessionManager';\nimport {kindeClient} from './kindeServerClient';\nimport {config} from '../config/index';\n/**\n * @callback getPermissions\n * @returns {Promise<import('../../types').KindePermissions | null>}\n */\n\n/**\n *\n * @param {import('next').NextApiRequest} [req]\n * @param {import('next').NextApiResponse} [res]\n * @returns {getPermissions}\n */\nexport const getPermissionsFactory = (req, res) => async () => {\n  try {\n    const permissions = await kindeClient.getPermissions(\n      await sessionManager(req, res)\n    );\n    return permissions;\n  } catch (error) {\n    if (config.isDebugMode) {\n      console.error(error);\n    }\n    return null;\n  }\n};\n","import {getFlagFactory} from './getFlag';\nimport {config} from '../config/index';\n/**\n * @callback getStringFlag\n * @param {string} code\n * @param {string} defaultValue\n * @returns {Promise<string | null>}\n */\n\n/**\n *\n * @param {import('next').NextApiRequest} [req]\n * @param {import('next').NextApiResponse} [res]\n * @returns {getStringFlag}\n */\nexport const getStringFlagFactory =\n  (req, res) => async (code, defaultValue) => {\n    try {\n      const flag = await getFlagFactory(req, res)(code, defaultValue, 's');\n      return flag.value;\n    } catch (err) {\n      if (config.isDebugMode) {\n        console.error(err);\n      }\n      return null;\n    }\n  };\n","import {KindeAccessToken, KindeIdToken, KindeUser} from '../../types';\n\ntype CustomPropertyType = Record<string, any>;\nexport const generateUserObject = (\n  idToken: KindeIdToken,\n  accessToken: KindeAccessToken\n) => {\n  const user: KindeUser<CustomPropertyType> = {\n    id: idToken.sub,\n    email: idToken.email,\n    family_name: idToken.family_name,\n    given_name: idToken.given_name,\n    picture: idToken.picture,\n    username: idToken.preferred_username,\n    phone_number: idToken.phone_number\n  };\n  let res = user;\n\n  const properties = idToken.user_properties || accessToken.user_properties;\n\n  if (properties) {\n    const {\n      kp_usr_city: cityObj,\n      kp_usr_industry: industryObj,\n      kp_usr_is_marketing_opt_in: isMarketingOptInObj,\n      kp_usr_job_title: jobTitleObj,\n      kp_usr_middle_name: middleNameObj,\n      kp_usr_postcode: postcodeObj,\n      kp_usr_salutation: salutationObj,\n      kp_usr_state_region: stateRegionObj,\n      kp_usr_street_address: streetAddressObj,\n      kp_usr_street_address_2: streetAddress2Obj,\n      ...rest\n    } = properties;\n\n    const sanitizedRest: Record<string, any> = Object.keys(rest).reduce(\n      (acc, key) => {\n        acc[key] = rest[key]?.v;\n        return acc;\n      },\n      {}\n    );\n    res = {\n      ...user,\n      properties: {\n        city: cityObj?.v,\n        industry: industryObj?.v,\n        is_marketing_opt_in: isMarketingOptInObj?.v,\n        job_title: jobTitleObj?.v,\n        middle_name: middleNameObj?.v,\n        postcode: postcodeObj?.v,\n        salutation: salutationObj?.v,\n        state_region: stateRegionObj?.v,\n        street_address: streetAddressObj?.v,\n        street_address_2: streetAddress2Obj?.v,\n        ...sanitizedRest\n      }\n    };\n  }\n  return res;\n};\n","import {NextApiRequest, NextApiResponse} from 'next';\nimport {KindeAccessToken, KindeIdToken, KindeUser} from '../../types';\nimport {config} from '../config/index';\nimport {generateUserObject} from '../utils/generateUserObject';\nimport {sessionManager} from './sessionManager';\nimport {jwtDecoder} from '@kinde/jwt-decoder';\n\nexport const getUserFactory =\n  (req: NextApiRequest, res: NextApiResponse) =>\n  async <T = Record<string, any>>(): Promise<KindeUser<T>> => {\n    try {\n      const session = await sessionManager(req, res);\n\n      const idToken = jwtDecoder<KindeIdToken>(\n        (await session.getSessionItem('id_token')) as string\n      );\n\n      const accessToken = jwtDecoder<KindeAccessToken>(\n        (await session.getSessionItem(\n          'access_token'\n        )) as string\n      );\n      return generateUserObject(idToken, accessToken) as KindeUser<T>;\n    } catch (error) {\n      if (config.isDebugMode) {\n        console.debug('getUser', error);\n      }\n      return null;\n    }\n  };\n","import {sessionManager} from './sessionManager';\nimport {kindeClient} from './kindeServerClient';\nimport {config} from '../config/index';\nimport {NextApiRequest, NextApiResponse} from 'next';\nimport {KindeOrganizations} from '../../types';\n\nexport const getUserOrganizationsFactory =\n  (req?: NextApiRequest, res?: NextApiResponse) =>\n  async (): Promise<KindeOrganizations | null> => {\n    try {\n      const session = await sessionManager(req, res);\n      const userOrgs = await kindeClient.getUserOrganizations(session);\n      const orgNames = (await kindeClient.getClaimValue(\n        session,\n        'organizations',\n        'id_token'\n      )) as {id: string; name: string}[];\n\n      const hasuraOrgCodes =\n        ((await kindeClient.getClaimValue(\n          session,\n          'x-hasura-org-codes',\n          'id_token'\n        )) as string[]) ?? [];\n\n      const hasuraOrganizations =\n        ((await kindeClient.getClaimValue(\n          session,\n          'x-hasura-organizations',\n          'id_token'\n        )) as {id: string; name: string}[]) ?? [];\n\n      return {\n        orgCodes: [...userOrgs.orgCodes, ...hasuraOrgCodes],\n        orgs: [...orgNames, ...hasuraOrganizations].map((org) => ({\n          code: org?.id,\n          name: org?.name\n        }))\n      };\n    } catch (error) {\n      if (config.isDebugMode) {\n        console.debug('getUserOrganization error:', error);\n      }\n      return null;\n    }\n  };\n","import {jwtDecoder, TokenPart} from '@kinde/jwt-decoder';\nimport {config} from '../../config/index';\n\nconst isTokenValid = (token) => {\n  const accessToken = token?.access_token ?? token;\n  if (!accessToken) return false;\n\n  const accessTokenHeader = jwtDecoder(accessToken, TokenPart.header);\n  const accessTokenPayload = jwtDecoder(accessToken);\n  let isAudienceValid = true;\n  if (config.audience)\n    isAudienceValid =\n      accessTokenPayload.aud &&\n      accessTokenPayload.aud.includes(...config.audience);\n\n  if (\n    accessTokenPayload.iss == config.issuerURL &&\n    accessTokenHeader.alg == 'RS256' &&\n    accessTokenPayload.exp > Math.floor(Date.now() / 1000) &&\n    isAudienceValid\n  ) {\n    return true;\n  } else {\n    return false;\n  }\n};\n\nexport {isTokenValid};\n","import {isTokenValid} from '../utils/pageRouter/isTokenValid';\nimport {getUserFactory} from './getUser';\nimport {sessionManager} from './sessionManager';\n\n/**\n *\n * @param {import('next').NextApiRequest} [req]\n * @param {import('next').NextApiResponse} [res]\n * @returns {() => Promise<boolean>}\n */\nexport const isAuthenticatedFactory = (req, res) => async () => {\n  const accessToken = await (\n    await sessionManager(req, res)\n  ).getSessionItem('access_token');\n\n  const validToken = isTokenValid(accessToken);\n\n  const user = await getUserFactory(req, res)();\n  return validToken && Boolean(user);\n};\n","import {sessionManager} from './sessionManager';\n\n/**\n * @callback getAccessTokenRaw\n * @returns {Promise<string>}\n */\n\n/**\n *\n * @param {import('next').NextApiRequest} [req]\n * @param {import('next').NextApiResponse} [res]\n *\n * @returns {getAccessTokenRaw}\n */\n// @ts-ignore\nexport const getAccessTokenRawFactory = (req, res) => async () => {\n  return await (await sessionManager(req, res)).getSessionItem('access_token');\n};\n","import {sessionManager} from './sessionManager';\n\n/**\n * @callback getIdTokenRaw\n * @returns {Promise<string>}\n */\n\n/**\n *\n * @param {import('next').NextApiRequest} [req]\n * @param {import('next').NextApiResponse} [res]\n * @returns {getIdTokenRaw}\n */\n\n// @ts-ignore\nexport const getIdTokenRawFactory = (req, res) => async () => {\n  return await (await sessionManager(req, res)).getSessionItem('id_token');\n};\n","import {sessionManager} from './sessionManager';\nimport {kindeClient} from './kindeServerClient';\nimport {config} from '../config/index';\n/**\n * @callback getRoles\n * @returns {Promise<import('../../types').KindeRoles | null>}\n */\n\n/**\n *\n * @param {import('next').NextApiRequest} [req]\n * @param {import('next').NextApiResponse} [res]\n * @returns {getRoles}\n */\nexport const getRolesFactory = (req, res) => async () => {\n  try {\n    const roles = await kindeClient.getClaimValue(\n      await sessionManager(req, res),\n      'roles'\n    );\n    return roles;\n  } catch (error) {\n    if (config.isDebugMode) {\n      console.error(error);\n    }\n    return null;\n  }\n};\n","import {sessionManager} from './sessionManager';\nimport {kindeClient} from './kindeServerClient';\nimport {config} from '../config/index';\n\n/**\n * @callback getClaim\n *  @param {string} claim\n *  @param {\"access_token\" | \"id_token\"} [type]\n * @returns {Promise<{name: string, value: string}> | null>}\n */\n\n/**\n *\n * @param {import('next').NextApiRequest} [req]\n * @param {import('next').NextApiResponse} [res]\n * @returns {getClaim}\n */\nexport const getClaimFactory = (req, res) => async (claim, type) => {\n  try {\n    const kindeClaim = await kindeClient.getClaim(\n      await sessionManager(req, res),\n      claim,\n      type\n    );\n    return kindeClaim;\n  } catch (error) {\n    if (config.isDebugMode) {\n      console.error(error);\n    }\n    return null;\n  }\n};\n","import {getAccessTokenFactory} from './getAccessToken';\nimport {getBooleanFlagFactory} from './getBooleanFlag';\nimport {getFlagFactory} from './getFlag';\nimport {getIdTokenFactory} from './getIdToken';\nimport {getIntegerFlagFactory} from './getIntegerFlag';\nimport {getOrganizationFactory} from './getOrganization';\nimport {getPermissionFactory} from './getPermission';\nimport {getPermissionsFactory} from './getPermissions';\nimport {getStringFlagFactory} from './getStringFlag';\nimport {getUserFactory} from './getUser';\nimport {getUserOrganizationsFactory} from './getUserOrganizations';\nimport {isAuthenticatedFactory} from './isAuthenticated';\nimport {getAccessTokenRawFactory} from './getAccessTokenRaw';\nimport {getIdTokenRawFactory} from './getIdTokenRaw';\nimport {kindeClient} from './kindeServerClient';\nimport {sessionManager} from './sessionManager';\nimport {getRolesFactory} from './getRoles';\nimport {getClaimFactory} from './getClaim';\nimport {config} from '../config/index';\nimport {NextApiRequest, NextApiResponse} from 'next';\n\nexport default function (req?: NextApiRequest, res?: NextApiResponse) {\n  return {\n    refreshTokens: async () => {\n      try {\n        // @ts-ignore\n        const response = await kindeClient.refreshTokens(\n          await sessionManager(req, res)\n        );\n        return response;\n      } catch (error) {\n        if (config.isDebugMode) {\n          console.error(error);\n        }\n        return null;\n      }\n    },\n    getAccessToken: getAccessTokenFactory(req, res),\n    getBooleanFlag: getBooleanFlagFactory(req, res),\n    getFlag: getFlagFactory(req, res),\n    getIdToken: getIdTokenFactory(req, res),\n    getIdTokenRaw: getIdTokenRawFactory(req, res),\n    getAccessTokenRaw: getAccessTokenRawFactory(req, res),\n    getIntegerFlag: getIntegerFlagFactory(req, res),\n    getOrganization: getOrganizationFactory(req, res),\n    getPermission: getPermissionFactory(req, res),\n    getPermissions: getPermissionsFactory(req, res),\n    getStringFlag: getStringFlagFactory(req, res),\n    getUser: getUserFactory(req, res),\n    getUserOrganizations: getUserOrganizationsFactory(req, res),\n    isAuthenticated: isAuthenticatedFactory(req, res),\n    getRoles: getRolesFactory(req, res),\n    getClaim: getClaimFactory(req, res)\n  };\n}\n","import {NextResponse} from 'next/server';\nimport {config} from '../config/index';\nimport {isTokenValid} from '../utils/pageRouter/isTokenValid';\nimport {type KindeAccessToken, KindeIdToken} from '../../types';\nimport {jwtDecoder} from '@kinde/jwt-decoder';\n\nconst trimTrailingSlash = (str) =>\n  str && str.charAt(str.length - 1) === '/' ? str.slice(0, -1) : str;\n\nexport function authMiddleware(request) {\n  const nextUrl = trimTrailingSlash(request.nextUrl.href);\n  const logoutUrl = trimTrailingSlash(config.postLogoutRedirectURL);\n  const kinde_token = request.cookies.get('kinde_token');\n  const isLogoutUrl = nextUrl === logoutUrl;\n\n  const isAuthenticated = isTokenValid(kinde_token?.value);\n\n  if (!isAuthenticated && !isLogoutUrl) {\n    return NextResponse.redirect(\n      new URL(config.postLogoutRedirectURL, request.url)\n    );\n  }\n\n  if (isAuthenticated && isLogoutUrl) {\n    return NextResponse.redirect(new URL(config.postLoginRedirectURL));\n  }\n\n  return NextResponse.next();\n}\n\nconst handleMiddleware = async (req, options, onSuccess) => {\n  const {pathname} = req.nextUrl;\n\n  const isReturnToCurrentPage = options?.isReturnToCurrentPage;\n  const loginPage = options?.loginPage || '/api/auth/login';\n\n  let publicPaths = ['/_next', '/favicon.ico'];\n  if (options?.publicPaths !== undefined) {\n    if (Array.isArray(options?.publicPaths)) {\n      publicPaths = options.publicPaths;\n    }\n  }\n\n  const loginRedirectUrl = isReturnToCurrentPage\n    ? `${loginPage}?post_login_redirect_url=${pathname}`\n    : loginPage;\n\n  if (loginPage == pathname || publicPaths.some((p) => pathname.startsWith(p)))\n    return;\n\n  const kindeToken = req.cookies.get('access_token');\n\n  if (!kindeToken) {\n    const response = NextResponse.redirect(\n      new URL(loginRedirectUrl, options?.redirectURLBase || config.redirectURL)\n    );\n    return response;\n  }\n\n  const accessTokenValue = jwtDecoder<KindeAccessToken>(\n    req.cookies.get('access_token')?.value\n  );\n  const idTokenValue = jwtDecoder<KindeIdToken>(\n    req.cookies.get('id_token')?.value\n  );\n\n  const isAuthorized = options?.isAuthorized\n    ? options.isAuthorized({req, token: accessTokenValue})\n    : isTokenValid(kindeToken.value);\n\n  if (isAuthorized && onSuccess) {\n    return await onSuccess({\n      token: accessTokenValue,\n      user: {\n        family_name: idTokenValue.family_name,\n        given_name: idTokenValue.given_name,\n        email: idTokenValue.email,\n        id: idTokenValue.sub,\n        picture: idTokenValue.picture\n      }\n    });\n  }\n\n  if (isAuthorized) {\n    return;\n  }\n\n  return NextResponse.redirect(\n    new URL(loginRedirectUrl, options?.redirectURLBase || config.redirectURL)\n  );\n};\n\n/**\n * @param {Request} [req]\n * @param {function(req: Request & {kindeAuth: {user: any, token: string}})} [onIsAuthorized]\n */\nexport function withAuth(...args) {\n  // most basic usage - no options\n  if (!args.length || args[0] instanceof Request) {\n    // @ts-ignore\n    return handleMiddleware(...args);\n  }\n\n  // passing through the kindeAuth data to the middleware function\n  if (typeof args[0] === 'function') {\n    const middleware = args[0];\n    const options = args[1];\n    return async (...args) =>\n      await handleMiddleware(args[0], options, async ({token, user}) => {\n        args[0].kindeAuth = {token, user};\n        return await middleware(...args);\n      });\n  }\n\n  // includes options\n  const options = args[0];\n  // @ts-ignore\n  return async (...args) => await handleMiddleware(args[0], options);\n}\n","import React from 'react';\nimport {config} from '../config/index';\n\n/**\n * @typedef {Object} PropsType\n * @prop {React.ReactNode} children\n * @prop {string} [orgCode]\n * @prop {string} [postLoginRedirectURL]\n * @prop {Object.<string, string>} [authUrlParams]\n *\n * @typedef {PropsType & React.AnchorHTMLAttributes<HTMLAnchorElement>} Props\n */\n\n/**\n * @param {Props} props\n */\n\nexport function RegisterLink({\n  children,\n  orgCode,\n  postLoginRedirectURL,\n  authUrlParams,\n  ...props\n}) {\n  let params = new URLSearchParams();\n  let paramsObj = {};\n  if (orgCode != null) paramsObj.org_code = orgCode;\n  if (postLoginRedirectURL != null)\n    paramsObj.post_login_redirect_url = postLoginRedirectURL;\n\n  paramsObj = {...authUrlParams, ...paramsObj};\n\n  for (const key in paramsObj) params.append(key, paramsObj[key]);\n  return (\n    <a\n      href={`${config.apiPath}/register${\n        params ? `?${params.toString()}` : ''\n      }`}\n      {...props}\n    >\n      {children}\n    </a>\n  );\n}\n","import React from 'react';\nimport {config} from '../config/index';\n\n/**\n * @typedef {Object} PropsType\n * @prop {React.ReactNode} children\n * @prop {string} [orgCode]\n * @prop {string} [postLoginRedirectURL]\n * @prop {Object.<string, string>} [authUrlParams]\n *\n * @typedef {PropsType & React.AnchorHTMLAttributes<HTMLAnchorElement>} Props\n */\n\n/**\n * @param {Props} props\n */\nexport function LoginLink({\n  children,\n  postLoginRedirectURL,\n  orgCode,\n  authUrlParams,\n  ...props\n}) {\n  const params = new URLSearchParams();\n  let paramsObj = {};\n  if (orgCode != null) paramsObj.org_code = orgCode;\n  if (postLoginRedirectURL != null) {\n    if (postLoginRedirectURL?.startsWith('/')) {\n      const host =\n        typeof window !== 'undefined'\n          ? window.location.origin\n          : process.env.KINDE_SITE_URL;\n      postLoginRedirectURL = `${host}${postLoginRedirectURL}`;\n    }\n    paramsObj.post_login_redirect_url = postLoginRedirectURL;\n  }\n\n  paramsObj = {...authUrlParams, ...paramsObj};\n\n  for (const key in paramsObj) params.append(key, paramsObj[key]);\n\n  const authUrl = `${config.apiPath}/login${\n    params ? `?${params.toString()}` : ''\n  }`;\n  return (\n    <a href={authUrl} {...props}>\n      {children}\n    </a>\n  );\n}\n","import React from 'react';\n\nimport {config} from '../config/index';\n/**\n * @typedef {Object} PropsType\n * @prop {React.ReactNode} children\n * @prop {string} [postLogoutRedirectURL]\n *\n * @typedef {PropsType & React.AnchorHTMLAttributes<HTMLAnchorElement>} Props\n */\n\n/**\n * @param {Props} props\n */\nexport function LogoutLink({children, postLogoutRedirectURL, ...props}) {\n  return (\n    <a\n      href={`${config.apiPath}/logout${\n        postLogoutRedirectURL\n          ? `?post_logout_redirect_url=${postLogoutRedirectURL}`\n          : ''\n      }\n      `}\n      {...props}\n    >\n      {children}\n    </a>\n  );\n}\n","import React from 'react';\n\nimport {config} from '../config/index';\n/**\n * @typedef {Object} PropsType\n * @prop {React.ReactNode} children\n * @prop {string} [orgName]\n *\n * @typedef {PropsType & React.AnchorHTMLAttributes<HTMLAnchorElement>} Props\n */\n\n/**\n * @param {Props} props\n */\nexport function CreateOrgLink({children, orgName, ...props}) {\n  return (\n    <a\n      href={`${config.apiPath}/create_org${\n        orgName ? `?org_name=${orgName}` : ''\n      }`}\n      {...props}\n    >\n      {children}\n    </a>\n  );\n}\n","import {\n  APIsApi,\n  ApplicationsApi,\n  BusinessApi,\n  CallbacksApi,\n  Configuration,\n  ConnectedAppsApi,\n  EnvironmentsApi,\n  FeatureFlagsApi,\n  IndustriesApi,\n  OAuthApi,\n  OrganizationsApi,\n  PermissionsApi,\n  RolesApi,\n  SubscribersApi,\n  TimezonesApi,\n  UsersApi\n} from '@kinde-oss/kinde-typescript-sdk';\nimport {config} from './config/index';\nimport {sessionManager} from './session/sessionManager';\nimport {isTokenValid} from './utils/pageRouter/isTokenValid';\n\n/**\n * Create the Kinde Management API client\n * @param {Request | import('next').NextApiRequest} [req] - optional request (required when used with pages router)\n * @param {Response | import('next').NextApiResponse} [res] - optional response (required when used with pages router)\n */\nexport const createKindeManagementAPIClient = async (req, res) => {\n  let apiToken = null;\n\n  const store = await sessionManager(req, res);\n  store.removeSessionItem('kinde_api_access_token');\n  \n  const response = await fetch(`${config.issuerURL}/oauth2/token`, {\n    method: 'POST',\n    headers: {\n      'content-type': 'application/x-www-form-urlencoded'\n    },\n    body: new URLSearchParams({\n      grant_type: 'client_credentials',\n      client_id: config.clientID || '',\n      client_secret: config.clientSecret || '',\n      audience: config.issuerURL + '/api'\n    })\n  });\n  apiToken = (await response.json()).access_token;\n\n  const cfg = new Configuration({\n    basePath: config.issuerURL,\n    accessToken: apiToken,\n    headers: {Accept: 'application/json'}\n  });\n\n  const usersApi = new UsersApi(cfg);\n  const oauthApi = new OAuthApi(cfg);\n  const subscribersApi = new SubscribersApi(cfg);\n  const organizationsApi = new OrganizationsApi(cfg);\n  const connectedAppsApi = new ConnectedAppsApi(cfg);\n  const featureFlagsApi = new FeatureFlagsApi(cfg);\n  const environmentsApi = new EnvironmentsApi(cfg);\n  const permissionsApi = new PermissionsApi(cfg);\n  const rolesApi = new RolesApi(cfg);\n  const businessApi = new BusinessApi(cfg);\n  const industriesApi = new IndustriesApi(cfg);\n  const timezonesApi = new TimezonesApi(cfg);\n  const applicationsApi = new ApplicationsApi(cfg);\n  const callbacksApi = new CallbacksApi(cfg);\n  const apisApi = new APIsApi(cfg);\n\n  return {\n    usersApi,\n    oauthApi,\n    subscribersApi,\n    organizationsApi,\n    connectedAppsApi,\n    featureFlagsApi,\n    environmentsApi,\n    permissionsApi,\n    rolesApi,\n    businessApi,\n    industriesApi,\n    timezonesApi,\n    applicationsApi,\n    callbacksApi,\n    apisApi\n  };\n};\n","import {NextResponse} from 'next/server';\n\nexport default class RouterClient {\n  /** @type {import('../../types').KindeClientConfig} */\n  clientConfig = {};\n  /** @type {import('../../types').KindeClient} */\n  kindeClient = null;\n  /** @type {URL} */\n  url;\n  /** @type {import('@kinde-oss/kinde-typescript-sdk').SessionManager} */\n  sessionManager;\n  /** @type {import('next').NextApiResponse | *} */\n  res;\n  /** @type {import('next').NextApiRequest | NextResponse | *} */\n  req;\n  /** @type {URLSearchParams} */\n  searchParams;\n\n  constructor() {\n    if (this.constructor == RouterClient) {\n      throw new Error(\"Abstract classes can't be instantiated.\");\n    }\n  }\n\n  /**\n   *\n   * @param {string} url\n   * @returns\n   */\n  redirect(url) {\n    throw new Error(\"Method 'redirect()' must be implemented.\");\n  }\n\n  /**\n   *\n   * @param {object} data\n   * @param {{status: number}} [status]\n   * @returns\n   */\n  json(data, status) {\n    throw new Error(\"Method 'json()' must be implemented.\");\n  }\n\n  error() {\n    throw new Error(\"Method 'error()' must be implemented.\");\n  }\n\n  /**\n   *\n   * @returns {URL}\n   */\n  getUrl() {\n    throw new Error(\"Method 'getUrl()' must be implemented.\");\n  }\n\n  /**\n   *\n   * @param {string} key\n   * @returns {string | null}\n   */\n  getSearchParam(key) {\n    throw new Error(\"Method 'getSearchParam()' must be implemented.\");\n  }\n\n  onError() {\n    throw new Error(\"Method 'onError()' must be implemented.\");\n  }\n}\n","import RouterClient from '../routerClients/RouterClient';\n\n/**\n *\n * @param {RouterClient} routerClient\n */\nexport const createOrg = async (routerClient) => {\n  const org_name = routerClient.getSearchParam('org_name');\n  const options = {\n    org_name: org_name ?? undefined,\n    is_create_org: true\n  };\n\n  const authUrl = await routerClient.kindeClient.createOrg(\n    routerClient.sessionManager,\n    options\n  );\n\n  return routerClient.redirect(authUrl.toString());\n};\n","import RouterClient from '../routerClients/RouterClient';\n\n/**\n *\n * @param {RouterClient} routerClient\n */\nexport const login = async (routerClient) => {\n  const authUrl = await routerClient.kindeClient.login(\n    routerClient.sessionManager,\n    {\n      authUrlParams: Object.fromEntries(routerClient.searchParams)\n    }\n  );\n\n  const postLoginRedirectURL = routerClient.getSearchParam(\n    'post_login_redirect_url'\n  );\n\n  if (postLoginRedirectURL) {\n    routerClient.sessionManager.setSessionItem(\n      'post_login_redirect_url',\n      postLoginRedirectURL\n    );\n  }\n\n  return routerClient.redirect(authUrl.toString());\n};\n","import {config} from '../config/index';\nimport RouterClient from '../routerClients/RouterClient';\n\n/**\n *\n * @param {RouterClient} routerClient\n */\nexport const logout = async (routerClient) => {\n  const authUrl = await routerClient.kindeClient.logout(\n    routerClient.sessionManager\n  );\n\n  let postLogoutRedirectURL =\n    routerClient.getSearchParam('post_logout_redirect_url') ||\n    config.postLogoutRedirectURL;\n  if (postLogoutRedirectURL?.startsWith('/')) {\n    postLogoutRedirectURL = config.redirectURL + postLogoutRedirectURL;\n  }\n  if (postLogoutRedirectURL) {\n    authUrl.searchParams.set('redirect', postLogoutRedirectURL);\n  }\n\n  return routerClient.redirect(authUrl.toString());\n};\n","import {config} from '../config/index';\nimport {NextResponse} from 'next/server';\nimport {validateClientSecret} from '@kinde-oss/kinde-typescript-sdk';\n\n/**\n *\n * @returns NextResponse\n */\nexport const health = async () => {\n  return NextResponse.json({\n    apiPath: config.apiPath,\n    redirectURL: config.clientOptions.redirectURL,\n    postLoginRedirectURL: config.postLoginRedirectURL,\n    issuerURL: config.issuerURL,\n    clientID: config.clientID,\n    clientSecret: validateClientSecret(config.clientSecret)\n      ? 'Set correctly'\n      : 'Not set correctly',\n    postLogoutRedirectURL: config.postLogoutRedirectURL,\n    audience: config.audience,\n    cookieDomain: config.cookieDomain,\n    logoutRedirectURL: config.clientOptions.logoutRedirectURL\n  });\n};\n","import RouterClient from '../routerClients/RouterClient';\n\n/**\n *\n * @param {RouterClient} routerClient\n */\nexport const register = async (routerClient) => {\n  const authUrl = await routerClient.kindeClient.register(\n    routerClient.sessionManager,\n    {\n      authUrlParams: Object.fromEntries(routerClient.searchParams)\n    }\n  );\n\n  const postLoginRedirectURL = routerClient.getSearchParam(\n    'post_login_redirect_url'\n  );\n\n  if (postLoginRedirectURL) {\n    routerClient.sessionManager.setSessionItem(\n      'post_login_redirect_url',\n      postLoginRedirectURL\n    );\n  }\n\n  return routerClient.redirect(authUrl.toString());\n};\n","import {createKindeServerClient} from '@kinde-oss/kinde-typescript-sdk';\nimport {cookies} from 'next/headers';\nimport {NextResponse} from 'next/server';\nimport {config} from '../config/index';\nimport {appRouterSessionManager} from '../session/sessionManager';\nimport RouterClient from './RouterClient';\n\nexport default class AppRouterClient extends RouterClient {\n  /**\n   *\n   * @param {import('next/server').NextRequest} req\n   * @param {*} res\n   * @param {{onError?: () => void; config: {audience?: string | string[], clientId?: string, clientSecret?: string, issuerURL?: string, siteUrl?: string, postLoginRedirectUrl?: string, postLogoutRedirectUrl?: string, scope?: string}}} options\n   */\n  constructor(req, res, options) {\n    super();\n    this.clientConfig = {\n      ...config.clientOptions,\n      framework: 'Next.js:App',\n      audience: options?.config?.audience || config.clientOptions.audience,\n      authDomain: options?.config?.issuerURL || config.clientOptions.authDomain,\n      clientId: options?.config?.clientId || config.clientOptions.clientId,\n      clientSecret:\n        options?.config?.clientSecret || config.clientOptions.clientSecret,\n      logoutRedirectURL:\n        options?.config?.postLogoutRedirectUrl ||\n        config.clientOptions.logoutRedirectURL,\n      redirectURL: options?.config?.siteUrl\n        ? `${options?.config?.siteUrl}/api/auth/kinde_callback`\n        : config.clientOptions.redirectURL,\n      siteUrl: config.redirectURL || options.config.siteUrl,\n      scope: options?.config?.scope || config.clientOptions.scope\n    };\n    this.kindeClient = createKindeServerClient(\n      config.grantType,\n      this.clientConfig\n    );\n    this.url = new URL(req.url);\n    \n    this.req = req;\n    this.searchParams = req.nextUrl.searchParams;\n    this.onErrorCallback = options?.onError;\n  }\n\n  async createStore () {\n    this.sessionManager = appRouterSessionManager(await cookies());\n  }\n\n  /**\n   *\n   * @param {string} url\n   * @returns\n   */\n  redirect(url) {\n    return NextResponse.redirect(url);\n  }\n\n  /**\n   *\n   * @returns {URL}\n   */\n  getUrl() {\n    return this.url;\n  }\n\n  /**\n   *\n   * @param {object} data\n   * @param {{status: number}} status\n   * @returns\n   */\n  json(data, status = {status: 200}) {\n    return NextResponse.json(data, status);\n  }\n\n  error() {\n    return Response.error;\n  }\n\n  /**\n   *\n   * @param {string} key\n   * @returns\n   */\n  getSearchParam(key) {\n    return this.req.nextUrl.searchParams.get(key);\n  }\n\n  onError(error) {\n    if (this.onErrorCallback) {\n      this.onErrorCallback(error);\n    }\n  }\n}\n","import {createKindeServerClient} from '@kinde-oss/kinde-typescript-sdk';\nimport {config} from '../config/index';\nimport {sessionManager} from '../session/sessionManager';\nimport RouterClient from './RouterClient';\n\n// @ts-ignore\nexport default class PagesRouterClient extends RouterClient {\n  /**\n   *\n   * @param {import('next').NextApiRequest} req\n   * @param {import('next').NextApiResponse} res\n   * @param {{onError?: () => void; config: {audience?: string | string[], clientId?: string, clientSecret?: string, issuerURL?: string, siteUrl?: string, postLoginRedirectUrl?: string, postLogoutRedirectUrl?: string, scope?: string}}} options\n   */\n  constructor(req, res, options) {\n    super();\n    const url = req.url.split('/');\n    url.pop();\n    this.clientConfig = {\n      ...config.clientOptions,\n      framework: 'Next.js:Pages',\n      audience: options?.config?.audience || config.clientOptions.audience,\n      authDomain: options?.config?.issuerURL || config.clientOptions.authDomain,\n      clientId: options?.config?.clientId || config.clientOptions.clientId,\n      clientSecret:\n        options?.config?.clientSecret || config.clientOptions.clientSecret,\n      logoutRedirectURL:\n        options?.config?.postLogoutRedirectUrl ||\n        config.clientOptions.logoutRedirectURL,\n      redirectURL: options?.config?.siteUrl\n        ? `${options?.config?.siteUrl}/api/auth/kinde_callback`\n        : config.clientOptions.redirectURL,\n      siteUrl: config.redirectURL || options.config.siteUrl\n    };\n    this.kindeClient = createKindeServerClient(\n      config.grantType,\n      this.clientConfig\n    );\n    // @ts-ignore\n    this.url = new URL(this.clientConfig.siteUrl + req.url);\n    this.res = res;\n    this.req = req;\n    this.searchParams = this.url.searchParams;\n    this.sessionManager = sessionManager(req, res);\n  }\n\n  /**\n   *\n   * @param {string} url\n   * @returns\n   */\n  redirect(url) {\n    return this.res.redirect(url);\n  }\n\n  getUrl() {\n    return this.url;\n  }\n  /**\n   *\n   * @param {object} data\n   * @param {{status: number}} status\n   * @returns\n   */\n  json(data, status = {status: 200}) {\n    return this.res.status(status.status).json(data);\n  }\n\n  /**\n   *\n   * @param {string} key\n   * @returns {string | null}\n   */\n  getSearchParam(key) {\n    return this.url.searchParams.get(key);\n  }\n}\n","import {isAppRouter} from '../utils/isAppRouter';\nimport {callback} from './callback';\nimport {createOrg} from './createOrg';\nimport {login} from './login';\nimport {logout} from './logout';\nimport {setup} from './setup';\nimport {health} from './health';\nimport {register} from './register';\nimport AppRouterClient from '../routerClients/AppRouterClient';\nimport PagesRouterClient from '../routerClients/PagesRouterClient';\nimport RouterClient from '../routerClients/RouterClient';\nimport {config} from '../config/index';\n\n/**\n * @type {Record<string,(routerClient: RouterClient) => Promise<void>>}\n */\nconst routeMap = {\n  create_org: createOrg,\n  register,\n  setup,\n  login,\n  logout,\n  health,\n  kinde_callback: callback\n};\n\n/**\n *\n * @param {string} endpoint\n * @returns\n */\nconst getRoute = (endpoint) => {\n  return routeMap[endpoint];\n};\n/**\n * @param {object} [request]\n * @param {string} [endpoint]\n * @param {{onError?: () => void; config: {audience?: string | string[], clientId?: string, clientSecret?: string, issuerURL?: string, siteUrl?: string, postLoginRedirectUrl?: string, postLogoutRedirectUrl?: string}}} [options]\n * @returns {(req, res) => any}\n */\nexport default (request, endpoint, options) => {\n  if (!config.clientOptions.authDomain)\n    throw new Error(\n      \"The environment variable 'KINDE_ISSUER_URL' is required. Set it in your .env file\"\n    );\n\n  if (!config.clientOptions.clientId && !options?.config?.clientId)\n    throw new Error(\n      \"env variable 'KINDE_CLIENT_ID' is not set and not passed in options\"\n    );\n\n  if (!config.clientOptions.clientSecret && !options?.config?.clientSecret)\n    throw new Error(\n      \"env variable 'KINDE_CLIENT_SECRET' is not set and not passed in options\"\n    );\n\n  if (!config.clientOptions.redirectURL && !options?.config?.siteUrl)\n    throw new Error(\n      \"env variable 'KINDE_SITE_URL' is not set and not passed in options\"\n    );\n\n  // For backwards compatibility in app router\n  if (typeof request == 'object' && typeof endpoint == 'string') {\n    // @ts-ignore\n    return appRouterHandler(request, {params: {kindeAuth: endpoint}}, options);\n  }\n  /**\n   *\n   * @param {import('next').NextApiRequest | Request} req\n   * @param {import('next').NextApiResponse | Response} res\n   */\n  return async function handler(req, res) {\n    return isAppRouter(req)\n      ? // @ts-ignore\n        appRouterHandler(req, res, options)\n      : // @ts-ignore\n        pagesRouterHandler(req, res, request);\n  };\n};\n\n/**\n *\n * @param {import('next/server').NextRequest} req\n * @param {{params: {kindeAuth: string}}} res\n * @param {{onError?: () => void}} options\n * @returns\n */\nconst appRouterHandler = async (req, res, options) => {\n  const {params} = res;\n  let endpoint = (await params).kindeAuth;\n  endpoint = Array.isArray(endpoint) ? endpoint[0] : endpoint;\n  const route = getRoute(endpoint);\n\n  if (route) {\n    const routerClient = new AppRouterClient(req, res, options)\n    await routerClient.createStore();\n    return await route(routerClient);\n  } else {\n    return new Response('This page could not be found.', {status: 404});\n  }\n\n};\n\n/**\n *\n * @param {import('next').NextApiRequest} req\n * @param {import('next').NextApiResponse} res\n * @param {{domain: string, clientId: string, clientSecret: string}} clientOptions\n * @returns\n */\nconst pagesRouterHandler = async (req, res, clientOptions) => {\n  let {\n    query: {kindeAuth: endpoint}\n  } = req;\n  endpoint = Array.isArray(endpoint) ? endpoint[0] : endpoint;\n  if (!endpoint) {\n    throw Error('Please check your Kinde setup');\n  }\n  const route = getRoute(endpoint);\n  return route\n    ? // @ts-ignore\n      await route(new PagesRouterClient(req, res, clientOptions))\n    : res.status(404).end();\n};\n","import {jwtDecoder} from '@kinde/jwt-decoder';\nimport {KindeAccessToken, KindeIdToken} from '../../types';\nimport {config} from '../config/index';\nimport {generateUserObject} from '../utils/generateUserObject';\n\n/**\n *\n * @param {RouterClient} routerClient\n * @returns\n */\nexport const setup = async (routerClient) => {\n  try {\n    const user = await routerClient.kindeClient.getUser(\n      routerClient.sessionManager\n    );\n\n    const accessTokenEncoded =\n      await routerClient.sessionManager.getSessionItem('access_token');\n\n    const idTokenEncoded =\n      await routerClient.sessionManager.getSessionItem('id_token');\n\n    const accessToken = jwtDecoder<KindeAccessToken>(accessTokenEncoded);\n\n    const idToken = jwtDecoder<KindeIdToken>(idTokenEncoded);\n\n    const permissions = await routerClient.kindeClient.getClaimValue(\n      routerClient.sessionManager,\n      'permissions'\n    );\n\n    const organization = await routerClient.kindeClient.getClaimValue(\n      routerClient.sessionManager,\n      'org_code'\n    );\n\n    const featureFlags = await routerClient.kindeClient.getClaimValue(\n      routerClient.sessionManager,\n      'feature_flags'\n    );\n\n    const userOrganizations = await routerClient.kindeClient.getClaimValue(\n      routerClient.sessionManager,\n      'org_codes',\n      'id_token'\n    );\n\n    const orgName = await routerClient.kindeClient.getClaimValue(\n      routerClient.sessionManager,\n      'org_name'\n    );\n\n    const orgProperties = await routerClient.kindeClient.getClaimValue(\n      routerClient.sessionManager,\n      'organization_properties'\n    );\n\n    const orgNames = await routerClient.kindeClient.getClaimValue(\n      routerClient.sessionManager,\n      'organizations',\n      'id_token'\n    );\n\n    return routerClient.json({\n      accessToken,\n      accessTokenEncoded,\n      accessTokenRaw: accessTokenEncoded,\n      idToken,\n      idTokenRaw: idTokenEncoded,\n      idTokenEncoded,\n      user: generateUserObject(\n        idToken as KindeIdToken,\n        accessToken as KindeAccessToken\n      ),\n      permissions: {\n        permissions,\n        orgCode: organization\n      },\n      needsRefresh: false,\n      organization: {\n        orgCode: organization,\n        orgName,\n        properties: {\n          city: orgProperties?.kp_org_city?.v,\n          industry: orgProperties?.kp_org_industry?.v,\n          postcode: orgProperties?.kp_org_postcode?.v,\n          state_region: orgProperties?.kp_org_state_region?.v,\n          street_address: orgProperties?.kp_org_street_address?.v,\n          street_address_2: orgProperties?.kp_org_street_address_2?.v\n        }\n      },\n      featureFlags,\n      userOrganizations: {\n        orgCodes: userOrganizations,\n        orgs: orgNames?.map((org) => ({\n          code: org?.id,\n          name: org?.name\n        }))\n      }\n    });\n  } catch (error) {\n    if (config.isDebugMode) {\n      console.debug(error);\n    }\n\n    if (error.code == 'ERR_JWT_EXPIRED') {\n      return routerClient.json(\n        {\n          needsRefresh: true\n        },\n        {status: 200}\n      );\n    }\n    return routerClient.json(\n      {\n        error\n      },\n      {status: 500}\n    );\n  }\n};\n","import {config} from '../config/index';\nimport RouterClient from '../routerClients/RouterClient';\n\nexport const callback = async (routerClient: RouterClient) => {\n  const postLoginRedirectURLFromMemory =\n    await routerClient.sessionManager.getSessionItem('post_login_redirect_url');\n\n  if (postLoginRedirectURLFromMemory) {\n    await routerClient.sessionManager.removeSessionItem(\n      'post_login_redirect_url'\n    );\n  }\n\n  const postLoginRedirectURL = postLoginRedirectURLFromMemory\n    ? postLoginRedirectURLFromMemory\n    : config.postLoginRedirectURL;\n  try {\n    await routerClient.kindeClient.handleRedirectToApp(\n      routerClient.sessionManager,\n      routerClient.getUrl()\n    );\n  } catch (error) {\n    if (config.isDebugMode) {\n      console.error('callback', error);\n    }\n\n    if (error.message.includes('Expected: State not found')) {\n      return routerClient.json(\n        {\n          error:\n            `Error: State not found.\\nTo resolve this error please visit our docs https://docs.kinde.com/developer-tools/sdks/backend/nextjs-sdk/#state-not-found-error` +\n            error.message\n        },\n        {status: 500}\n      );\n    }\n\n    return routerClient.json({error: error.message}, {status: 500});\n  }\n  if (postLoginRedirectURL) {\n    if (postLoginRedirectURL.startsWith('http')) {\n      return routerClient.redirect(postLoginRedirectURL);\n    }\n    return routerClient.redirect(\n      `${routerClient.clientConfig.siteUrl}${postLoginRedirectURL}`\n    );\n  }\n\n  return routerClient.redirect(routerClient.clientConfig.siteUrl);\n};\n","export {default as getKindeServerSession} from '../session/index';\nimport {redirect} from 'next/navigation';\nimport {NextResponse} from 'next/server';\n\n/**\n * A higher-order function that wraps a page component and adds protection logic.\n * @param {import('react').ReactNode} page - The page component to be protected.\n * @param {Object} config - The configuration options for the protection logic.\n * @param {string} config.redirect - The redirect path if the user is not authenticated or does not have the required role or permissions.\n * @param {string[]} config.roles - The required role(s) for accessing the protected page.\n * @param {string|string[]} config.permissions - The required permission(s) for accessing the protected page.\n * @returns {Function} - The protected page component.\n */\n\nexport const protectPage =\n  (Page, config = {redirect: '/api/auth/login'}) =>\n  async (props) => {\n    const {isAuthenticated, getPermission, getPermissions, getRoles} = kinde();\n    try {\n      const isSignedIn = await isAuthenticated();\n\n      if (!isSignedIn) {\n        return redirect(config.redirect);\n      }\n\n      if (config.roles) {\n        const roles = await getRoles();\n        if (!roles) return redirect(config.redirect);\n        const roleNames = new Set(roles.map((r) => r.name));\n        if (!config.roles.some((role) => roleNames.has(role))) {\n          return redirect(config.redirect);\n        }\n      }\n\n      if (typeof config.permissions === 'string') {\n        const hasPermission = await getPermission(config.permissions);\n        if (!hasPermission) {\n          return redirect(config.redirect);\n        }\n      }\n\n      if (Array.isArray(config.permissions)) {\n        const permissions = await getPermissions();\n        if (\n          !config.permissions.some((permission) =>\n            permissions.includes(permission)\n          )\n        ) {\n          return redirect(config.redirect);\n        }\n      }\n    } catch (error) {\n      console.error('Error protecting page', error);\n      return null;\n    }\n\n    return <Page {...props} />;\n  };\n\n/**\n * Protects a Next.js API route handler with authentication and authorization.\n * @param {Function} handler - The Next.js API route handler.\n * @param {Object} config - The configuration object.\n * @param {string[]} config.roles - The required role(s) for accessing the protected page.\n * @param {string|string[]} config.permissions - The required permission(s) for accessing the protected page.\n * @returns {Function} - The protected API route handler.\n */\n\nexport const protectApi = (handler, config) => async (req) => {\n  const {isAuthenticated, getPermission, getPermissions, getRoles} = kinde();\n  try {\n    const isSignedIn = await isAuthenticated();\n\n    if (!isSignedIn) {\n      return NextResponse.json({statusCode: 401, message: 'Unauthorized'});\n    }\n\n    if (config.roles) {\n      const roles = await getRoles();\n      if (!roles)\n        return NextResponse.json({statusCode: 401, message: 'Unauthorized'});\n      const roleNames = new Set(roles.map((r) => r.name));\n      if (!config.roles.some((role) => roleNames.has(role))) {\n        return NextResponse.json({statusCode: 401, message: 'Unauthorized'});\n      }\n    }\n\n    if (typeof config.permissions === 'string') {\n      const hasPermission = await getPermission(config.permissions);\n      if (!hasPermission) {\n        return NextResponse.json({statusCode: 403, message: 'Forbidden'});\n      }\n    }\n\n    if (Array.isArray(config.permissions)) {\n      const permissions = await getPermissions();\n      if (\n        !config.permissions.some((permission) =>\n          permissions.includes(permission)\n        )\n      ) {\n        return NextResponse.json({statusCode: 403, message: 'Forbidden'});\n      }\n    }\n  } catch (error) {\n    console.error('Error protecting page', error);\n    return null;\n  }\n\n  return handler(req);\n};\n"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","throw","return","Symbol","iterator","v","op","TypeError","pop","push","__spreadArray","to","from","pack","ar","l","Array","slice","concat","SuppressedError","isAppRouter","req","Request","removeTrailingSlash","url","trim","endsWith","KINDE_SITE_URL","process","env","KINDE_AUTH_API_PATH","NEXT_PUBLIC_KINDE_AUTH_API_PATH","KINDE_POST_LOGIN_REDIRECT_URL","KINDE_POST_LOGIN_URL_REDIRECT_URL","KINDE_POST_LOGOUT_REDIRECT_URL","KINDE_ISSUER_URL","KINDE_CLIENT_ID","KINDE_CLIENT_SECRET","KINDE_AUDIENCE","KINDE_COOKIE_DOMAIN","KINDE_SCOPE","config","isDebugMode","KINDE_DEBUG_MODE","apiPath","initialState","accessToken","idToken","isAuthenticated","isLoading","organization","permissions","user","userOrganizations","getAccessToken","getBooleanFlag","getClaim","getFlag","getIdToken","getIntegerFlag","getOrganization","getPermission","getPermissions","getStringFlag","getToken","getUser","getUserOrganizations","refreshData","SESSION_PREFIX","redirectURL","postLoginRedirectURL","issuerURL","clientID","clientSecret","postLogoutRedirectURL","audience","split","cookieDomain","responseType","codeChallengeMethod","redirectRoutes","callback","issuerRoutes","logout","login","register","token","profile","clientOptions","authDomain","clientId","logoutRedirectURL","frameworkVersion","scope","grantType","cookie","require","TWENTY_NINE_DAYS","GLOBAL_COOKIE_OPTIONS","sameSite","httpOnly","secure","NODE_ENV","path","COOKIE_LIST","sessionManager","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","res","cookieStore","wrap","_context","prev","cookies","abrupt","appRouterSessionManager","pageRouterSessionManager","t0","stop","_x","_x2","getSessionItem","itemKey","item","get","jsonValue","JSON","parse","_typeof","error","setSessionItem","itemValue","undefined","set","stringify","_objectSpread","maxAge","domain","removeSessionItem","destroySession","forEach","name","getHeader","isArray","toString","setHeader","_toConsumableArray","filter","startsWith","serialize","map","getAccessTokenFactory","jwtDecoder","t1","t2","console","kindeClient","createKindeServerClient","GrantType","AUTHORIZATION_CODE","getFlagFactory","code","defaultValue","flagType","flag","t3","t4","t5","message","includes","_x3","getBooleanFlagFactory","getIdTokenFactory","getIntegerFlagFactory","getOrganizationFactory","_orgProperties$kp_org","_orgProperties$kp_org2","_orgProperties$kp_org3","_orgProperties$kp_org4","_orgProperties$kp_org5","_orgProperties$kp_org6","session","org","orgName","orgProperties","getClaimValue","orgCode","properties","city","kp_org_city","industry","kp_org_industry","postcode","kp_org_postcode","state_region","kp_org_state_region","street_address","kp_org_street_address","street_address_2","kp_org_street_address_2","getPermissionFactory","permission","getPermissionsFactory","getStringFlagFactory","generateUserObject","id","sub","email","family_name","given_name","picture","username","preferred_username","phone_number","user_properties","cityObj","kp_usr_city","industryObj","kp_usr_industry","isMarketingOptInObj","jobTitleObj","kp_usr_job_title","middleNameObj","kp_usr_middle_name","postcodeObj","salutationObj","kp_usr_salutation","stateRegionObj","kp_usr_state_region","streetAddressObj","streetAddress2Obj","kp_usr_street_address_2","rest_1","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__rest","sanitizedRest","keys","reduce","acc","key","_a","is_marketing_opt_in","job_title","middle_name","salutation","getUserFactory","_c","_b","debug","error_1","getUserOrganizationsFactory","userOrgs","orgNames","hasuraOrgCodes","hasuraOrganizations","orgCodes","orgs","isTokenValid","_token$access_token","_accessTokenPayload$a","access_token","accessTokenHeader","TokenPart","header","accessTokenPayload","isAudienceValid","aud","iss","alg","exp","Math","floor","Date","now","isAuthenticatedFactory","validToken","Boolean","getAccessTokenRawFactory","getIdTokenRawFactory","getRolesFactory","roles","getClaimFactory","claim","type","kindeClaim","index","_this","refreshTokens","getIdTokenRaw","getAccessTokenRaw","getRoles","trimTrailingSlash","str","charAt","authMiddleware","request","nextUrl","href","logoutUrl","kinde_token","isLogoutUrl","NextResponse","redirect","URL","handleMiddleware","options","onSuccess","pathname","isReturnToCurrentPage","loginPage","publicPaths","loginRedirectUrl","some","kindeToken","accessTokenValue","idTokenValue","isAuthorized","redirectURLBase","withAuth","args","_i","middleware_1","options_1","kindeAuth","RegisterLink","children","authUrlParams","props","_objectWithoutProperties","_excluded","params","URLSearchParams","paramsObj","org_code","post_login_redirect_url","append","React","createElement","_extends","LoginLink","_postLoginRedirectURL","host","window","location","origin","authUrl","LogoutLink","CreateOrgLink","createKindeManagementAPIClient","apiToken","response","cfg","usersApi","oauthApi","subscribersApi","organizationsApi","connectedAppsApi","featureFlagsApi","environmentsApi","permissionsApi","rolesApi","businessApi","industriesApi","timezonesApi","applicationsApi","callbacksApi","apisApi","fetch","method","headers","grant_type","client_id","client_secret","json","Configuration","basePath","Accept","UsersApi","OAuthApi","SubscribersApi","OrganizationsApi","ConnectedAppsApi","FeatureFlagsApi","EnvironmentsApi","PermissionsApi","RolesApi","BusinessApi","IndustriesApi","TimezonesApi","ApplicationsApi","CallbacksApi","APIsApi","RouterClient","_createClass","_classCallCheck","_defineProperty","constructor","Error","data","status","createOrg","routerClient","org_name","getSearchParam","is_create_org","fromEntries","searchParams","_postLogoutRedirectUR","health","validateClientSecret","AppRouterClient","_RouterClient","_options$config","_options$config2","_options$config3","_options$config4","_options$config5","_options$config6","_options$config7","_options$config8","_callSuper","clientConfig","framework","postLogoutRedirectUrl","siteUrl","onErrorCallback","onError","_inherits","_createStore","Response","PagesRouterClient","routeMap","create_org","setup","_g","accessTokenEncoded","idTokenEncoded","featureFlags","accessTokenRaw","idTokenRaw","needsRefresh","_d","_e","_f","kinde_callback","postLoginRedirectURLFromMemory","handleRedirectToApp","getUrl","getRoute","endpoint","auth","appRouterHandler","_handler","pagesRouterHandler","_callee2","route","_context2","createStore","_x4","_x5","_ref2","_callee3","_context3","query","end","_x6","_x7","_x8","protectPage","Page","_kinde","roleNames","kinde","Set","r","role","has","protectApi","handler","_kinde2","statusCode"],"mappings":"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"}